<html>
    
    <head>
        <title>Disabled Routing</title>
        <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico">
                    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="">
                        <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    </head>
    
    <body>
        <div id="mapid" style="width: 100%; height: 100%; position: relative; outline: none;" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0">
            <div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);">
                <div class="leaflet-pane leaflet-tile-pane">
                    <div class="leaflet-layer " style="z-index: 1; opacity: 1;">
                        <div class="leaflet-pane leaflet-overlay-pane">
                            <svg pointer-events="none" class="leaflet-zoom-animated" width="720" height="480" viewBox="-60 -40 720 480" style="transform: translate3d(-60px, -40px, 0px);">
                                <g>
                                    
                                </g>
                            </svg>
                        </div>
                        <div class="leaflet-control-container">
                            <div class="leaflet-top leaflet-left">
                                <div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#" title="Zoom in" role="button" aria-label="Zoom in">+</a><a class="leaflet-control-zoom-out" href="#" title="Zoom out" role="button" aria-label="Zoom out">−</a></div>
                            </div>
                            <div class="leaflet-top leaflet-right"></div>
                            <div class="leaflet-bottom leaflet-left"></div>
                            <div class="leaflet-bottom leaflet-right">
                                <div class="leaflet-control-attribution leaflet-control"><a href="" title="A JS library for interactive maps">Leaflet</a> | Map data © <a href="">OpenStreetMap</a> contributors, <a href="">CC-BY-SA</a>, Imagery © <a href="">Mapbox</a></div>
                            </div>
                        </div>
                    </div>
                    <!---->
                    <script>
                        var mymap = L.map('mapid');
                        var polylineIdCount = -1;
                        var popup = L.popup();
                        var sourceMarker;
                        var midMarker;
                        var navigationMarker;
                        var destinationMarker;
                        var userMarker;
                        var polylines = [];
                        var nodesMarker = [];
                        var lastSelectedPolyline;
                        var lastSelectedNode;
                        var busStopIcon = L.icon({
                                                 iconUrl: 'ic_directions_bus_18pt.png',
                                                 iconRetinaUrl: 'ic_directions_bus_18pt_2x.png',
                                                 iconSize: [18, 18],
                                                 shadowAnchor: [15, 40],
                                                 iconAnchor: [9, 18],
                                                 popupAnchor: [1, -34],
                                                 tooltipAnchor: [16, -28],
                                                 shadowSize: [41, 41]
                                                 });
                                                 var parkingIcon = L.icon({
                                                                          iconUrl: 'parking.png',
                                                                          iconRetinaUrl: 'parking_2x.png',
                                                                          iconSize: [18, 18],
                                                                          shadowAnchor: [15, 40],
                                                                          iconAnchor: [9, 18],
                                                                          popupAnchor: [1, -34],
                                                                          tooltipAnchor: [16, -28],
                                                                          shadowSize: [41, 41]
                                                                          });
                                                                          var nodeIcon = L.icon({
                                                                                                iconUrl: 'node_marker.png',
                                                                                                iconRetinaUrl: 'node_marker_2x.png',
                                                                                                iconSize: [45, 30],
                                                                                                shadowAnchor: [15, 40],
                                                                                                iconAnchor: [22.5, 30],
                                                                                                popupAnchor: [1, -34],
                                                                                                tooltipAnchor: [16, -28],
                                                                                                shadowSize: [41, 41]
                                                                                                });
                                                                                                var nodeGreenIcon = L.icon({
                                                                                                                           iconUrl: 'node_marker_green.png',
                                                                                                                           iconRetinaUrl: 'node_marker_green_2x.png',
                                                                                                                           iconSize: [45, 30],
                                                                                                                           shadowAnchor: [15, 40],
                                                                                                                           iconAnchor: [22.5, 30],
                                                                                                                           popupAnchor: [1, -34],
                                                                                                                           tooltipAnchor: [16, -28],
                                                                                                                           shadowSize: [41, 41]
                                                                                                                           });
                                                                                                                           var trainIcon = L.icon({
                                                                                                                                                  iconUrl: 'ic_train_18pt.png',
                                                                                                                                                  iconRetinaUrl: 'ic_train_18pt_2x.png',
                                                                                                                                                  iconSize: [18, 18],
                                                                                                                                                  shadowAnchor: [15, 40],
                                                                                                                                                  iconAnchor: [9, 18],
                                                                                                                                                  popupAnchor: [1, -34],
                                                                                                                                                  tooltipAnchor: [16, -28],
                                                                                                                                                  shadowSize: [41, 41]
                                                                                                                                                  });
                                                                                                                                                  var toiletIcon = L.icon({
                                                                                                                                                                          iconUrl: 'ic_wc_18pt.png',
                                                                                                                                                                          iconRetinaUrl: 'ic_wc_18pt_2x.png',
                                                                                                                                                                          shadowUrl: 'marker-shadow.png',
                                                                                                                                                                          iconSize: [18, 18],
                                                                                                                                                                          shadowAnchor: [15, 40],
                                                                                                                                                                          iconAnchor: [9, 18],
                                                                                                                                                                          popupAnchor: [1, -34],
                                                                                                                                                                          tooltipAnchor: [16, -28],
                                                                                                                                                                          shadowSize: [41, 41]
                                                                                                                                                                          });
                                                                                                                                                                          var sourceIcon = L.icon({
                                                                                                                                                                                                  iconUrl: 'pin_a.png',
                                                                                                                                                                                                  iconRetinaUrl: 'pin_a_2x.png',
                                                                                                                                                                                                  shadowUrl: 'marker-shadow.png',
                                                                                                                                                                                                  iconSize: [42, 72],
                                                                                                                                                                                                  shadowAnchor: [11, 62],
                                                                                                                                                                                                  iconAnchor: [21, 72],
                                                                                                                                                                                                  popupAnchor: [1, -34],
                                                                                                                                                                                                  tooltipAnchor: [16, -28],
                                                                                                                                                                                                  shadowSize: [41, 41]
                                                                                                                                                                                                  });
                                                                                                                                                                                                  var navigationIcon = L.icon({
                                                                                                                                                                                                                              iconUrl: 'ic_navigation.png',
                                                                                                                                                                                                                              iconRetinaUrl: 'ic_navigation_2x.png',
                                                                                                                                                                                                                              iconSize: [50, 50],
                                                                                                                                                                                                                              iconAnchor: [25, 50]
                                                                                                                                                                                                                              });
                                                                                                                                                                                                                              var midPointIcon = L.icon({
                                                                                                                                                                                                                                                        iconUrl: 'pin_c.png',
                                                                                                                                                                                                                                                        iconRetinaUrl: 'pin_c_2x.png',
                                                                                                                                                                                                                                                        shadowUrl: 'marker-shadow.png',
                                                                                                                                                                                                                                                        iconSize: [42, 72],
                                                                                                                                                                                                                                                        shadowAnchor: [11, 62],
                                                                                                                                                                                                                                                        iconAnchor: [21, 72],
                                                                                                                                                                                                                                                        popupAnchor: [1, -34],
                                                                                                                                                                                                                                                        tooltipAnchor: [16, -28],
                                                                                                                                                                                                                                                        shadowSize: [41, 41]
                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                        var destinationIcon = L.icon({
                                                                                                                                                                                                                                                                                     iconUrl: 'pin_b.png',
                                                                                                                                                                                                                                                                                     iconRetinaUrl: 'pin_b_2x.png',
                                                                                                                                                                                                                                                                                     iconSize: [42, 72],
                                                                                                                                                                                                                                                                                     shadowUrl: 'marker-shadow.png',
                                                                                                                                                                                                                                                                                     shadowAnchor: [11, 62],
                                                                                                                                                                                                                                                                                     iconAnchor: [21, 72],
                                                                                                                                                                                                                                                                                     popupAnchor: [1, -34],
                                                                                                                                                                                                                                                                                     tooltipAnchor: [16, -28],
                                                                                                                                                                                                                                                                                     shadowSize: [41, 41]
                                                                                                                                                                                                                                                                                     });
                                                                                                                                                                                                                                                                                     var userIcon = L.icon({
                                                                                                                                                                                                                                                                                                           iconUrl: 'loc_2x.png',
                                                                                                                                                                                                                                                                                                           iconRetinaUrl: 'loc_3x.png',
                                                                                                                                                                                                                                                                                                           iconSize: [50, 50],
                                                                                                                                                                                                                                                                                                           iconAnchor: [25, 50],
                                                                                                                                                                                                                                                                                                           popupAnchor: [1, -34],
                                                                                                                                                                                                                                                                                                           tooltipAnchor: [16, -28],
                                                                                                                                                                                                                                                                                                           shadowSize: [41, 41]
                                                                                                                                                                                                                                                                                                           });
                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                           L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                                                                                                                                                                                                                                                                                                                       maxZoom: 18,
                                                                                                                                                                                                                                                                                                                       attribution: 'Map data &copy; <a href="">OpenStreetMap</a> contributors, ' +
                                                                                                                                                                                                                                                                                                                       '<a href="">CC-BY-SA</a>, ' +
                                                                                                                                                                                                                                                                                                                       'Imagery © <a href="">Mapbox</a>',
                                                                                                                                                                                                                                                                                                                       id: 'mapbox.streets'
                                                                                                                                                                                                                                                                                                                       }).addTo(mymap);
                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                       function setMapZoom(zoom) {
                                                                                                                                                                                                                                                                                                                           mymap.setZoom(zoom);
                                                                                                                                                                                                                                                                                                                       }
                    
                    function setMapView(lat, long, zoom) {
                        
                        mymap.setView([lat, long], zoom);
                        
                        mymap.on('moveend', onMapMoveEnd);
                        mymap.on('movestart', onMapMoveStart);
                        mymap.on('zoom', onZoomlevelschange);
                        
                    }
                    function drawPolyline(latlngs, color, padding, clickable) {
                        var polyline;
                        polyline = L.polyline(latlngs, {
                                              color: color,
                                              weight: 10,
                                              interactive: clickable
                                              }).addTo(mymap);
                                              polylineIdCount = polylineIdCount + 1
                                              // mymap.fitBounds(polyline.getBounds(),{padding:padding});
                                              
                                              polyline.on('click', onPolylineClick);
                                              polylines.push(polyline);
                                              lastSelectedPolyline = polyline;
                    }
                    
                    function boundMap(latlngs, padding) {
                        mymap.fitBounds(latlngs, {
                                        padding: padding
                                        });
                    }
                    
                    function changeColorOfPolyline(index) {
                        var poly = polylines[index];
                        // mymap.fitBounds(poly.getLatLngs,{padding:[5,5]});
                        lastSelectedPolyline.setStyle({
                                                      color: '#a50050',
                                                      weight: 10
                                                      });
                                                      poly.setStyle({
                                                                    color: 'green',
                                                                    weight: 10
                                                                    });
                                                                    lastSelectedPolyline = poly;
                                                                    
                    }
                    
                    function removePolyline() {
                        polyline = nil;
                    }
                    function showNodes() {
                        nodesMarker.forEach(addNode);
                    }
                    function addNode(value, index, array) {
                        value.addTo(mymap);
                    }
                    function removeNodes() {
                        nodesMarker.forEach(removeNode);
                    }
                    function removeNode(value, index, array) {
                        mymap.removeLayer(value);
                    }
                    function addSourceMarkerOnMap(lat, long, address) {
                        sourceMarker = L.marker([lat, long], {
                                                icon: sourceIcon
                                                });
                                                sourceMarker.bindPopup('<h3><strong>' + address + '</strong></h3>').openPopup();
                                                sourceMarker.addTo(mymap);
                    }
                    
                    function addMidPointMarkerOnMap(lat, long, address) {
                        midMarker = L.marker([lat, long], {
                                             icon: midPointIcon
                                             });
                                             midMarker.bindPopup('<h3><strong>' + address + '</strong></h3>').openPopup();
                                             midMarker.addTo(mymap);
                    }
                    
                    function addNavigationMarkerOnMap(lat, long) {
                        navigationMarker = L.marker([lat, long], {
                                                    icon: navigationIcon
                                                    });
                                                    navigationMarker.addTo(mymap);
                    }
                    
                    function panMapto(lat, long) {
                        mymap.fitBounds([new L.LatLng(lat, long)], {
                                        padding: padding
                                        });
                    }
                    
                    function changePositionOfMarker(lat, long) {
                        userMarker.setLatLng(new L.LatLng(lat, long));
                    }
                    
                    function addDestinationMarkerOnMap(lat, long, address) {
                        destinationMarker = L.marker([lat, long], {
                                                     icon: destinationIcon
                                                     });
                                                     destinationMarker.bindPopup('<h3><strong>' + address + '</strong></h3>').openPopup();
                                                     destinationMarker.addTo(mymap);
                    }
                    
                    function addBusStopMarkerOnMap(lat, long, wheelChair, publicTransfer) {
                        var busMarker = L.marker([lat, long], {
                                                 icon: busStopIcon
                                                 });
                                                 busMarker.bindPopup('<h3><strong>' + publicTransfer + '</strong><br />Wheelchair access: ' + wheelChair + '.</h3>').openPopup();
                                                 busMarker.addTo(mymap);
                                                 nodesMarker.push(busMarker);
                    }
                    
                    function addTrainMarkerOnMap(lat, long, wheelChair, publicTransfer) {
                        var trainMarker = L.marker([lat, long], {
                                                   icon: trainIcon
                                                   });
                                                   trainMarker.bindPopup('<h3><strong>' + publicTransfer + '</strong><br />Wheelchair access: ' + wheelChair + '.</h3>').openPopup();
                                                   trainMarker.addTo(mymap);
                                                       nodesMarker.push(trainMarker);
                    }
                    
                    function addToiletMarkerOnMap(lat, long, wheelChair, publicTransfer) {
                        var toiletMarker = L.marker([lat, long], {
                                                    icon: toiletIcon
                                                    });
                                                    toiletMarker.bindPopup('<h3><strong>' + publicTransfer + '</strong><br />Wheelchair access: ' + wheelChair + '.</h3>').openPopup();
                                                    toiletMarker.addTo(mymap);
                                                            nodesMarker.push(toiletMarker);
                    }
                    
                    function addParkingMarkerOnMap(lat, long, wheelChair, publicTransfer) {
                        var parkingMarker = L.marker([lat, long], {
                                                     icon: parkingIcon
                                                     });
                                                     parkingMarker.bindPopup('<h3><strong>' + publicTransfer + '</strong><br />Wheelchair access: ' + wheelChair + '.</h3>').openPopup();
                                                     parkingMarker.addTo(mymap);
                                                      nodesMarker.push(parkingMarker);
                    }
                    
                    function addNodeMarker(lat, long) {
                        var nodeMarker = L.marker([lat, long], {
                                                  icon: nodeIcon
                                                  });
                                                  nodeMarker.addTo(mymap);
                                                  nodeMarker.on('click', onNodeClick);
                                                  lastSelectedNode = nodeMarker;
                    }
                    function addValidatedNodeMarker(lat, long) {
                        var nodeMarker = L.marker([lat, long], {
                                                  icon: nodeGreenIcon
                                                  });
                                                  nodeMarker.addTo(mymap);
                                                  nodeMarker.on('click', onValidatedNodeClick);
                    }
                    
                    function addUserMarkerOnMap(lat, long) {
                        userMarker = L.marker([lat, long], {
                                              icon: userIcon
                                              });
                                              userMarker.addTo(mymap);
                    }
                    
                    function removeAllLayers() {
                        
                        polylineIdCount = -1;
                        polylines.length = 0;
                        nodesMarker.length = 0;
                        mymap.eachLayer(function(layer) {
                                        if (layer instanceof L.Marker) {
                                        mymap.removeLayer(layer);
                                        } else if (layer instanceof L.Path) {
                                        mymap.removeLayer(layer);
                                        }
                                        });
                    }
                    
                    function onPolylineClick(e) {
                        lastSelectedPolyline.setStyle({
                                                      color: lastSelectedPolyline.options.color,
                                                      weight: 10
                                                      });
                                                      var color = this.options.color;
                                                      lastSelectedPolyline = this;
                                                      this.setStyle({
                                                                    color: 'green',
                                                                    weight: 15
                                                                    });
                                                                    lastSelectedPolyline.options.color = color;
                                                                    window.webkit.messageHandlers["POLYLINE_TAPPED"].postMessage(this.getLatLngs());
                    }
                    
                    function onNodeClick(e) {
                        lastSelectedNode.setIcon(nodeIcon);
                        this.setIcon(nodeGreenIcon);
                        window.webkit.messageHandlers["NODE_TAPPED"].postMessage(this.getLatLng());
                        lastSelectedNode = this;
                    }
                    function onValidatedNodeClick(e) {
                        window.webkit.messageHandlers["NODE_TAPPED"].postMessage(this.getLatLng());
                    }
                    function onMapMoveEnd(e) {
                        window.webkit.messageHandlers["MAP_MOVE_END_EVENT"].postMessage(this.getCenter());
                    }
                    function onZoomlevelschange(e) {
                        window.webkit.messageHandlers["MAP_ZOOM_LEVEL_CHANGED"].postMessage(this.getZoom());
                    }
                    function onMapMoveStart(e) {
                        window.webkit.messageHandlers["MAP_MOVE_START_EVENT"].postMessage(this.getCenter());
                    }
                    </script>
    </body>
    
</html>
